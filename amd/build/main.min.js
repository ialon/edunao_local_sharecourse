define("local_sharecourse/main",["jquery","core/ajax","core/templates","core/notification","core/str","qrcode"],(function($,Ajax,Templates,Notification,str,QRCode){return{init:function(courseName,courseUrl,extendedHTML,ltiUrl,ltiCode,hasLti){this.courseName=courseName,this.extendedHTML=extendedHTML,this.ltiUrl=ltiUrl,this.ltiCode=ltiCode,this.hasLti=hasLti,this.courseUrl=courseUrl,this.encodedUrl=encodeURIComponent(courseUrl),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",this.moveMenuItem.bind(this)):this.moveMenuItem()},moveMenuItem:function(){let shareItemLink=document.querySelector('li[data-key="sharecourse"] a');if(!shareItemLink)return;let shareItemClone=shareItemLink.cloneNode(!0);shareItemClone.removeAttribute("role"),shareItemClone.removeAttribute("tabindex"),shareItemClone.classList.remove("dropdown-item"),shareItemClone.classList.add("btn","btn-sm","btn-info","float-right","align-items-center","ml-3"),shareItemClone.style.height="fit-content",shareItemClone.innerHTML='<i class="fa fa-share mr-2"></i> Share';let courseTitle=document.querySelector(".page-header-headings");courseTitle&&courseTitle.parentNode.insertBefore(shareItemClone,courseTitle.nextSibling),shareItemClone.addEventListener("click",(event=>{event.preventDefault(),this.showModal()})),shareItemLink.addEventListener("click",(event=>{event.preventDefault(),this.showModal()}))},showModal:async function(){if(document.getElementById("shareModal"))return void $("#shareModal").modal("show");let emailsubject=await str.get_string("share_email_subject","local_sharecourse",{coursename:this.courseName}),emailbody=await str.get_string("share_email_body","local_sharecourse",{courseurl:this.courseUrl,coursename:this.courseName});const context={courseurl:this.courseUrl,encodedurl:this.encodedUrl,extendedhtml:this.extendedHTML,ltiurl:this.ltiUrl,lticode:this.ltiCode,haslti:this.hasLti,emailsubject:emailsubject,emailbody:encodeURIComponent(emailbody)};Templates.render("local_sharecourse/modal",context).done(function(html,js){document.body.insertAdjacentHTML("beforeend",html),Templates.runTemplateJS(js),$("#shareModal").modal("show");let qrcodeContainer=document.getElementById("qrcode");new QRCode(qrcodeContainer,{text:this.courseUrl,width:256,height:256}),this.addCopyEventListener("copy-courseurl-button",this.courseUrl),this.addCopyEventListener("copy-ltiurl-button",this.ltiUrl),this.addCopyEventListener("copy-lticode-button",this.ltiCode);const event=new CustomEvent("shareModalLoaded",{bubbles:!0});document.dispatchEvent(event)}.bind(this)).fail(Notification.exception)},addCopyEventListener:function(buttonId,textToCopy){let button=document.getElementById(buttonId);button&&button.addEventListener("click",(function(){let copyButton=document.getElementById(buttonId);navigator.clipboard.writeText(textToCopy).then((async function(){let copiedlabel=await str.get_string("copied_clipboard","local_sharecourse");copyButton.setAttribute("data-original-title",copiedlabel),$(copyButton).tooltip("show")})).catch(Notification.exception),copyButton.addEventListener("mouseleave",(async function(){let copylabel=await str.get_string("copy_clipboard","local_sharecourse");copyButton.setAttribute("data-original-title",copylabel),$(copyButton).tooltip("hide")}),{once:!0})}))}}}));

//# sourceMappingURL=main.min.js.map